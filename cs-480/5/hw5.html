<html>
<head>
<title>HW 5 - CS 480 M01 Fall 2020 </title>
<style>
<!--
@import url(../cs480.css);
-->
</style>

</head>
<body>
<h2>CS 480 M01 Fall 2020 - Homework Assignment #5</h2>

<b>Due:</b> 11:59 PM Thu, Nov 5 2020<br>
<b>Assignment:</b><p>

<b>Points:</b> 90 points total</br> &nbsp; (plus 10 more points for the extra credit)
<p>
<strong><font color="purple">
	Each exercise below is to be implemented on your cs480 virtual host. 
	Every question asked needs to be answered in your assignment report. 
	For every exercise describe in sufficient detail the whole process and explain what you did to accomplish the task.
	Make sure that you list and discuss all important steps made, commands used together with their options, and problems encountered.
</font>
</strong></p>

<p>
<ol type="I">
	<li> 8 pts:  <b>Repositories and Updates</b></br>
		Configure SW Repositories and Install Updates<ol type="a">
                <li>use zypper to check / list the configured repositories (showing repositories with their URIs and priorities) , and</br>
                        remove and add repositories as needed to have them configured as follows:
<pre>
#|Alias      |Name                   |Enabled|GPG Check|Refresh|Priority|Type  |URI                                                  |Service
-+-----------+-----------------------+-------+---------+-------+--------+------+-----------------------------------------------------+-------
1|leap152full| openSUSE-Leap15.2-Full| Yes   |( p) Yes | Yes   |   99   |rpm-md|nfs://lbc/csvm1_2/opensuse/distribution/15.2/repo/oss|
2|updatesOSS | Leap 15.2 Updates OSS | Yes   |( p) Yes | Yes   |   99   |rpm-md|nfs://lbc/csvm1_2/opensuse/updates/leap/15.2/oss     |
</pre>
or (if refresh was already done and local repo caches built)
<pre>
#|Alias      |Name                   |Enabled|GPG Check|Refresh|Priority|Type  |URI                                                  |Service
-+-----------+-----------------------+-------+---------+-------+--------+------+-----------------------------------------------------+-------
1|leap152full| openSUSE-Leap15.2-Full| Yes   |(r ) Yes | Yes   |   99   |rpm-md|nfs://lbc/csvm1_2/opensuse/distribution/15.2/repo/oss|
2|updatesOSS | Leap 15.2 Updates OSS | Yes   |(r ) Yes | Yes   |   99   |rpm-md|nfs://lbc/csvm1_2/opensuse/updates/leap/15.2/oss     |
</pre>
		</li>
                <li>List the available updates.</br>
                                Note that zypper should refresh / check for new updates automatically - don't forget the relevant option when adding the repository in the step above.
<pre># zypper <i>list_available_updates_command</i>
Loading repository data...
Reading installed packages...
S | Repository            | Name                                | Current Version     | Available Version     | Arch
--+-----------------------+-------------------------------------+---------------------+-----------------------+-------
v | Leap 15.2 Updates OSS | ImageMagick                         | 7.0.7.34-lp152.11.6 | 7.0.7.34-lp152.12.3.1 | x86_64
v | Leap 15.2 Updates OSS | ImageMagick-config-7-SUSE           | 7.0.7.34-lp152.11.6 | 7.0.7.34-lp152.12.3.1 | x86_64
v | Leap 15.2 Updates OSS | MozillaFirefox                      | 68.9.0-lp152.1.1    | 78.4.0-lp152.2.24.1   | x86_64
v | Leap 15.2 Updates OSS | MozillaFirefox-translations-common  | 68.9.0-lp152.1.1    | 78.4.0-lp152.2.24.1   | x86_64
v | Leap 15.2 Updates OSS | NetworkManager                      | 1.22.6-lp152.1.4    | 1.22.10-lp152.2.3.1   | x86_64

...</pre></li>
<li>Install the updates. (<i>This step should install ~350 updates and will take couple of minutes to finish.</i>)</li>
                <li>Check if the reboot is needed and if that is the case then reboot the host.</li>
                </ol>
                        In you report include all commands you ran to accomplish the tasks above.
        </li>

	<li>4 points: <b>lshw and kernel sources</b></br> Check if  <b>lshw</b> is already installed on your system. If it is not installed yet then install it using <b>zypper</b>.</br>
		Use <b>zypper</b> to also install <b>kernel-source</b> and <b>kernel-devel</b> packages (plus all packages that these two depend on).</br>
		</li>
		<li>20 points : </br>Read all <strong>man pages</strong> listed below (from sections 1 , 5, or 8; try the commands, look into the files, ... while reading) and in a short paragraph (3-5 lines per man page in your words - do not just copy parts of the man page) describe what is each of them for. Also, for the commands choose an extra option (not the help nor version options) and in few more lines describe situations in which you would use the selected option. In case of the commands with long man pages and many options choose at least two extra options and describe situations in which you would use them.
		<ol type="1">
			<li>df</li>
			<li>du</li>
			<li>fdisk</li>
			<li>fsck</li>
			<li>lsblk</li>
			<li>lshw</li>
			<li>mke2fs [-j]     - try it on   /extra</li>
			<li>mkfs</li>
			<li>mkfs.ext4</li>
			<li>mount           - try it on   /extra</li>
			<li>parted</li>
			<li>partprobe</li>
			<li>tune2fs</li>
			<li>udisksctl</li>
			<li>umount           - try it on   /extra</li>
		</ol>
	</li>
	<li>4 points :<b> lastlog &amp; wtmp rotation policies</b><ul>
			 What is the difference between <b>lastlog </b> and <b> wtmp</b> files?</br>
			 What is a reasonable rotation policy for each?</br>
			 Explain / justify your answers.
		</ul>
	</li>
	<li>6 points : <b>dmesg vs messages vs journalctl</b><ul>
			Investigate output of <b>dmesg</b>  command on your VM and
			compare it with the recent entries in <b>/var/log/messages </b>file as well as
			with the recent entries displayed by the  <b>journalctl</b> command. </br>
    			How do these log entries differ (or do not differ)?  What info can be found where?
		</ul>
	</li>
	<li>8 pts: <b>rsyslog</b><ul>
		<li>Decipher the default <b>rsyslog</b> configuration on your system :</br>
			Describe in detail what files are used to configure it, what is being logged through rsyslog and how.</br>
			What would you change, why ?
		</li>
       		<li>Implement one of your suggestions : modify the config file(s) and make sure that it works as expected.</br>
			<i>(it may be a good idea to back up the original file(s) first:
				<b><em>cp &nbsp; -p &nbsp;  /etc/somefile.conf  &nbsp;  /etc/somefile.conf.orig</em></b>)</i>
		</li>
		</ul>
        </li>
	<li>6 pts: <b>systemd journal</b><ul>
			Modify configuration of your system to <ol>
				<li>Keep old journal entries after reboots.</li>
				<li>Keep at most 100 messages per minute produced by a service.  </br>
					<i>(If a service generated 10,000 messages in a minute then for every minute only the first 100 are 
						kept and the rest is dropped / not logged).</li>
			</ol>
		</ul>
	

	<li>14 points : <b>Disk Partitioning</b></br> New (sdb) disk was added to your virtual machine. Partition (gpt not dos) the disk and create new file systems as needed and as outlined below.</br>
		Using only the commands listed above (<i>under the man pages exercise</i>) create two new partitions
		(<i>you may NOT  use <code>yast/yast2</code> nor <code>gdisk</code> nor <code>gparted </code></i>).</br>
		The first is to be <b>4GB</b>  large (new sdb1)  and it will have <b>EXT4</b> file system.</br>
		The other partition (sdb2) will occupy the rest of the disk and will have <b>EXT2</b> file system. </br>
		Mount the partitions under <b>/cs480</b> (4GB) and <b>/lab5</b>.
		Some of the steps needed for this exercise (not necessarily in this order) may be:
		<ul>
		<li>Check the current state : <b>df -kl , mount, lsblk <i>some_option</i>,  ...</b></li>
		<li>Partition the disk ( <b>fdisk</b>, <b>parted</b>,  ... ) </li>
	      	<li>Make <b>EXT4</b> file system on <b>sdb1</b> and <b>EXT2</b> FS on <b>sdb2</b></li>
	        <li>Modify <b>fstab</b> and add entries for  <b>/cs480</b> and  <b>/lab5</b></li>
	        <li>Create new directories as needed.</li>
	        <li>Mount the new partitions. Make sure that the 4GB partition (/dev/sdb1) is mounted under <b>/cs480</b></li>
	        <p>
	        <li>Reboot if  or as necessary.
	                <br>What commands did you use and in what order? Why? Does it matter what is the order of the steps above? Which steps, why ? </li>
	        <li>Make sure that once you are done and whenever your computer gets rebooted it will have  both <b>/cs480</b> and <b>/lab5</b> mounted correctly.<br>
	        <p>
			Describe  the whole process and answer ALL questions in your report. </li>
	    </ul>
	</li>

	<li><b>Extracredit</b> 10 points : <b>Superblock</b><ol>
		<li>What is superblock and what is it used for?</li>
		<li>Look up the definition of the ext4 superblock structure in the kernel header files on your virtual cs480 computer 
		and
			<ol type="a">
			<li>Count the number of fields in the <font color=purple>ext4_super_block</font> structure. How many are there?</li>
			<li>Choose <font color=purple>10</font> fields in the <font color=purple>ext4_super_block</font> structure and discuss what each of the fields represents.</li>
			</ol>   
		<i>You will need to have kernel sources installed already - one of the tasks/exercises above.
		Kernel source files will be installed in <code>/usr/src/linux</code>. Search the header files to find the needed C structure.
		</i>
		</li>
		</ol>
	</li>
</ol>

<p><strong>Submitted files, overall quality, length, and feedback:</strong> <i></i></p>
<ol type="I" start="10">
	<li>5 points : <strong>Submit all relevant files</strong> you modified during the lab (into the /home/CS480/yourcsloginname directory as part of the tar.bz2 file) . Exactly two files need to be submitted: One file being your report in <strong>PDF</strong> is to be submitted on the Blackboard. The other file is the <strong>tar.bz2</strong> file containing everything else and it gets submitted into <strong>/home/CS480</strong> (Pack the files together using <strong>tar</strong> and <strong>bzip2</strong>, and copy them using <strong>scp</strong> from your computer into your cs account )</li>
	<li>&nbsp;10 points : Submit your report as a <strong>PDF document</strong> through learn.nmsu.edu and all supporting documents, programs, and execution transcripts as part of the tar.bz2 file in your directory under /home/CS480. The report has to contain answers to all questions above, and for the practical problems on your computer describe in detail choices you made, difficulties you encountered, and how did you deal with them.</li>
	<li>5 points : <strong>Feedback:</strong>In the last paragraph of your report estimate how much time you spent on this assignment. Describe what was hard, easy, interesting, boring or confusing.</li>
</ol>
<p><strong>Please remember the submission requirements:</strong></p>
<ul>
<strong>Two files need to be submitted for every assignment :</strong>
		<ol>
			<li>The first file is your <strong>typed report </strong>. <br /> It has to be submitted through <strong><a href="http://learn.nmsu.edu" target="_top">http://learn.nmsu.edu</a></strong> <strong> as one file / document</strong> and it has to be <strong>in the PDF format</strong>. <br />No other format will be accepted. The name of the file has to contain your name and assignment/lab number separated by "_" (If your name is John Smith then the name of the document submitted for this assignment needs to be <strong>John_Smith_HW05.pdf</strong>). &nbsp;</li>
			<li>The second file to be submitted into your directory under <strong>/home/CS480</strong> directory has to be a <strong>tar.bz2</strong> file that contains all other files related to the assignment. <br /> It will contain all relevant files that you modified for the assignment. Everything that was done to finish the lab, modify your system, write, run and verify submitted programs and scripts used needs to be included in the submitted tar.bz2 file. That includes all your system configuration files modified for the lab/assignment as well as programs and scripts written (including complete source code, supporting shell scripts, test data input files, ...). The name of the tar.bz2 file has to contain your CS login name and the lab number separated by "_" (if your cs login name was jsmith then the file's name for this assignment will be <strong>jsmith_Lab05.tar.bz2</strong> ). &nbsp; The files submitted as part of the tar.bz2 file have to be exact copies as found on your cs480 lab system.
			</li>
</ol>
<p>If you want to correct or add something to already submitted assignment than you need to do so before the deadline and <strong>resubmit the whole report again and also resubmit your new tar.bz2 file </strong>.</p>
<p>Please remember that <strong>late submissions are penalized 20% / day and NO submissions that are late 3 or more days will be accepted</strong>. You can be late at most 2 days to receive any points.</p>
<p>&nbsp;</p>
</ul>
</body>
</html>
